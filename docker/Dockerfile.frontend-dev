FROM node:16

RUN curl -f https://get.pnpm.io/v6.16.js | node - add --global pnpm

WORKDIR /dashboard

COPY ./package.json ./pnpm-lock.yaml ./pnpm-workspace.yaml ./.npmrc ./
COPY ./apps/frontend/package.json ./apps/frontend/

RUN pnpm i --frozen-lockfile --ignore-scripts && pnpm --filter frontend i

COPY ./ ./

CMD ["pnpm", "--filter", "frontend", "start:dev"]
